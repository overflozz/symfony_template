<div class="container-fluid">
	<div class="headermodal">
		Visite {{ event.id }} 	<button type="button" id="closeModal" class="btn btn-default pull-right " data-dismiss="modal"><span class="glyphicon glyphicon-remove "></span></button>
	</div>
	<div class="contentModal"> 
		Le <b>{{event.startDatetime|date("d/m/Y", "Europe/Paris")}}</b> de <b>{{event.startDatetime|date("H:i", "Europe/Paris")}}</b> à <b>{{event.endDatetime|date("H:i", "Europe/Paris")}}</b>
		<div class="divider"></div>
		<b><span class="glyphicon glyphicon-bullhorn" style="border-radius:50%; background-color:#2ecc71;padding : 3px; font-size:12px; color:#fff;"></span> Conférenciers : </b>
		<ul>
			{% for participant in Participants %}
				<li>{{participant.user.prenom}} {{participant.user.nom}}  {% if participant.user == app.user%} <button id="suppr_conferencier" type="button" class="btn btn-outline-danger"><span class='glyphicon glyphicon-remove'></span> Supprimer</button>{% endif %}</li>
			{% endfor %}
			{% for i in 1..(event.nbUserMax - Participants|length) %}
				<li>
					N/A
					{% if is_granted("IS_AUTHENTICATED_REMEMBERED") and userParticipe == false and i==1 %}
						<button id="ajout_conferencier" class="btn btn-outline-primary" type="button"><span class='glyphicon glyphicon-plus'></span> S'ajouter</button>
					{% endif %}
				</li>
			{% endfor %}
		</ul>
		<span class="glyphicon glyphicon-thumbs-up" style="border-radius:50%; background-color:#f1c40f;padding : 3px; font-size:12px; color:#fff;"></span>  <b>Reponsable Qualité</b> : {{event.respoQuali.prenom }} {{event.respoQuali.nom }}<br />
		<div class="divider"></div>
		<div class="row">
			<div class="col-md-6 pull-left">
				<b>Langue</b> : {{ event.langue }}<br />
				<b>Client</b> : {{ event.client }} <br />

			</div>
			<div class="col-md-6  pull-right">
				<b>Nombre de visiteurs</b> : {{ event.nombreParticipants }} <br />
				<b>Type de public</b> : {{ event.typeclient }} <br />
			</div>
		</div>
</div>

<div class="row-fluid">
	{% if is_granted("IS_AUTHENTICATED_REMEMBERED") and userParticipe == true %}
		<a href="{{ path('of_calendar_view_visite',{'id' : event.id, 'etape' : event.step})}}" type="button" id="viewModal" class="btn btn-default col-xs-12" ><span class="glyphicon glyphicon-eye-open"></span> Voir</a>
	{% else  %}
		<a href="{{ path('of_calendar_view_visite',{'id' : event.id, 'etape' : event.step})}}" type="button" id="viewModal" class="btn btn-default col-xs-12 hidden" ><span class="glyphicon glyphicon-eye-open"></span> Voir</a>
	{% endif %}
</div>
</div>
<script>

	{% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
	$(document).ready(function(){

		$('.contentModal').on("click", "#ajout_conferencier",function(){
			var $div = $("#ajout_conferencier").parent();
			$div.html('');
			$('#loading-image').clone().appendTo($div);
			$('#loading-image').fadeIn(1000);
			$.ajax({
				url: "{{ path('of_calendar_ajoutUserEvent', {'id' : event.id})}}",
				method: "post",
				data:{idUser: {{ app.user.id}}}

			}).done(function(){
				$("#viewModal").removeClass("hidden").hide().fadeIn(1000);

				$('#loading-image').fadeOut(1000);
				$div.html("{{ app.user.prenom}} {{ app.user.nom}}<button id='suppr_conferencier'  class='btn btn-outline-danger' type='button' ><span class='glyphicon glyphicon-remove'></span> Supprimer</button>");
			});
		});
		$('.contentModal').on("click", "#suppr_conferencier",function(){
			var $div = $("#suppr_conferencier").parent();
			$div.html('');
			$('#loading-image').clone().appendTo($div);
			$('#loading-image').show();
			$.ajax({
				url: "{{ path('of_calendar_supprUserEvent', {'id' : event.id})}}",
				method: "post",
				data:{idUser: {{ app.user.id}}}

			}).done(function(){
				$("#viewModal").fadeOut(1000);
				
				$('#loading-image').fadeOut(500);

				$div.html("N/A <button id='ajout_conferencier' class='btn btn-outline-primary' type='button' ><span class='glyphicon glyphicon-plus'></span> S'ajouter</button>");
			});
		});
	});
	{% endif %}
	
</script>